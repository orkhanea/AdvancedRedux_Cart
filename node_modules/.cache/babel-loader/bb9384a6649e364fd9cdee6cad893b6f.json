{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport { cartButtonActions } from \"./ui\";\nconst initialCartState = {\n  totalProductCount: 0,\n  totalAmount: 0,\n  cartItems: []\n};\nconst cartSlice = createSlice({\n  name: 'cart',\n  initialState: initialCartState,\n  reducers: {\n    addToCart(state, action) {\n      const updatedTotalAmount = state.totalAmount + action.payload.price;\n      const updatedTotalProductCount = state.totalProductCount + action.payload.amount;\n      const existingCartItemIndex = state.cartItems.findIndex(item => item.id === action.payload.id);\n      const existngCartItem = state.cartItems[existingCartItemIndex];\n      let updatedItems;\n\n      if (existngCartItem) {\n        const updatedItem = { ...existngCartItem,\n          amount: existngCartItem.amount + action.payload.amount\n        };\n        updatedItems = [...state.cartItems];\n        updatedItems[existingCartItemIndex] = updatedItem;\n      } else {\n        updatedItems = state.cartItems.concat(action.payload);\n      }\n\n      state.cartItems = updatedItems;\n      state.totalAmount = updatedTotalAmount;\n      state.totalProductCount = updatedTotalProductCount;\n    },\n\n    removeFromCart(state, action) {\n      const existingCartItemIndex = state.cartItems.findIndex(item => item.id === action.payload.id);\n      const existingCartItem = state.cartItems[existingCartItemIndex];\n      const updatedTotalAmount = state.totalAmount - existingCartItem.price;\n      const updatedTotalProductCount = state.totalProductCount - action.payload.amount;\n      let updatedItems;\n\n      if (existingCartItem && existingCartItem.amount > 1) {\n        const updatedItem = { ...existingCartItem,\n          amount: existingCartItem.amount - 1\n        };\n        updatedItems = [...state.cartItems];\n        updatedItems[existingCartItemIndex] = updatedItem;\n      } else if (existingCartItem && existingCartItem.amount === 1) {\n        updatedItems = state.cartItems.filter(item => item.id !== action.payload.id);\n      }\n\n      state.cartItems = updatedItems;\n      state.totalAmount = updatedTotalAmount;\n      state.totalProductCount = updatedTotalProductCount;\n    }\n\n  }\n});\nexport const sendCartData = cartData => {\n  console.log(cartData);\n  return async dispatch => {\n    dispatch(cartButtonActions.showNotification({\n      status: 'pending',\n      title: 'Sending...',\n      message: 'Sending cart data!'\n    }));\n\n    const fetchData = async () => {\n      const response = await fetch('https://cartreact-342a6-default-rtdb.firebaseio.com/cart.json', {\n        method: 'PUT',\n        body: JSON.stringify(cartData)\n      });\n\n      if (!response.ok) {\n        throw new Error('Something went wrong!');\n      }\n    };\n\n    try {\n      await fetchData();\n      dispatch(cartButtonActions.showNotification({\n        status: 'success',\n        title: 'Success!',\n        message: 'Sent cart data successfully!'\n      }));\n    } catch (error) {\n      dispatch(cartButtonActions.showNotification({\n        status: 'error',\n        title: 'Error',\n        message: 'Sending cart data failed!'\n      }));\n    }\n  };\n};\nexport const cartActions = cartSlice.actions;\nexport default cartSlice.reducer;","map":{"version":3,"names":["createSlice","cartButtonActions","initialCartState","totalProductCount","totalAmount","cartItems","cartSlice","name","initialState","reducers","addToCart","state","action","updatedTotalAmount","payload","price","updatedTotalProductCount","amount","existingCartItemIndex","findIndex","item","id","existngCartItem","updatedItems","updatedItem","concat","removeFromCart","existingCartItem","filter","sendCartData","cartData","console","log","dispatch","showNotification","status","title","message","fetchData","response","fetch","method","body","JSON","stringify","ok","Error","error","cartActions","actions","reducer"],"sources":["/Users/orkhan/Downloads/01-starting-project-2/src/store/cart-slice.js"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\"\nimport { cartButtonActions } from \"./ui\"\n\nconst initialCartState = { totalProductCount: 0, totalAmount: 0, cartItems: [] }\nconst cartSlice = createSlice({\n    name: 'cart',\n    initialState: initialCartState,\n    reducers: {\n        addToCart(state, action) {\n\n            const updatedTotalAmount = state.totalAmount + action.payload.price\n            const updatedTotalProductCount = state.totalProductCount + action.payload.amount\n            const existingCartItemIndex = state.cartItems.findIndex(item => item.id === action.payload.id)\n            const existngCartItem = state.cartItems[existingCartItemIndex];\n            let updatedItems;\n\n            if (existngCartItem) {\n                const updatedItem = {\n                    ...existngCartItem,\n                    amount: existngCartItem.amount + action.payload.amount\n                };\n                updatedItems = [...state.cartItems];\n                updatedItems[existingCartItemIndex] = updatedItem\n            }\n            else {\n                updatedItems = state.cartItems.concat(action.payload);\n            }\n\n            state.cartItems = updatedItems\n            state.totalAmount = updatedTotalAmount\n            state.totalProductCount = updatedTotalProductCount\n\n        },\n        removeFromCart(state, action) {\n            const existingCartItemIndex = state.cartItems.findIndex(item => item.id === action.payload.id)\n            const existingCartItem = state.cartItems[existingCartItemIndex];\n            const updatedTotalAmount = state.totalAmount - existingCartItem.price\n            const updatedTotalProductCount = state.totalProductCount - action.payload.amount\n            let updatedItems;\n\n            if (existingCartItem && existingCartItem.amount > 1) {\n                const updatedItem = { ...existingCartItem, amount: existingCartItem.amount - 1 }\n                updatedItems = [...state.cartItems]\n                updatedItems[existingCartItemIndex] = updatedItem\n            }\n            else if (existingCartItem && existingCartItem.amount === 1) {\n                updatedItems = state.cartItems.filter(item => item.id !== action.payload.id)\n            }\n\n            state.cartItems = updatedItems\n            state.totalAmount = updatedTotalAmount\n            state.totalProductCount = updatedTotalProductCount\n        }\n    }\n})\n\nexport const sendCartData = (cartData) => {\n    console.log(cartData)\n    return async (dispatch) => {\n\n        dispatch(cartButtonActions.showNotification({\n            status: 'pending',\n            title: 'Sending...',\n            message: 'Sending cart data!'\n        }))\n\n        const fetchData = async () => {\n            const response = await fetch('https://cartreact-342a6-default-rtdb.firebaseio.com/cart.json', {\n                method: 'PUT',\n                body: JSON.stringify(cartData)\n            })\n\n            if (!response.ok) {\n                throw new Error('Something went wrong!')\n            }\n        }\n\n        try {\n            await fetchData()\n\n           dispatch(cartButtonActions.showNotification({\n               status: 'success',\n               title: 'Success!',\n               message: 'Sent cart data successfully!'\n           }))\n\n       } catch (error) {\n           dispatch(cartButtonActions.showNotification({\n               status: 'error',\n               title: 'Error',\n               message: 'Sending cart data failed!'\n           }))\n       }\n\n    }\n}\n\nexport const cartActions = cartSlice.actions;\nexport default cartSlice.reducer"],"mappings":"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"},"metadata":{},"sourceType":"module"}